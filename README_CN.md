# tsuniqid

[English](./README.md) | [ä¸­æ–‡æ–‡æ¡£](./README_CN.md)

ä¸€ä¸ªé«˜æ€§èƒ½çš„ Go è¯­è¨€å”¯ä¸€ ID ç”Ÿæˆå™¨ï¼Œæä¾›å­—ç¬¦ä¸²å’Œ uint64 ç±»å‹çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œå…·æœ‰å‡ºè‰²çš„å¹¶å‘å®‰å…¨æ€§å’Œæ€§èƒ½ç‰¹å¾ã€‚

[![Go Report Card](https://goreportcard.com/badge/github.com/tinystack/tsuniqid)](https://goreportcard.com/report/github.com/tinystack/tsuniqid)
![Go Version](https://img.shields.io/badge/go%20version-%3E=1.18-61CFDD.svg?style=flat-square)
[![PkgGoDev](https://pkg.go.dev/badge/mod/github.com/tinystack/tsuniqid)](https://pkg.go.dev/mod/github.com/tinystack/tsuniqid)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

## ç‰¹æ€§

- **ğŸš€ é«˜æ€§èƒ½**: å­—ç¬¦ä¸² ID ~443 ns/opï¼Œuint64 ID ~24 ns/op
- **ğŸ”’ çº¿ç¨‹å®‰å…¨**: åŸºäºåŸå­æ“ä½œçš„å®Œå…¨å¹¶å‘å®‰å…¨
- **ğŸ¯ å”¯ä¸€æ€§ä¿è¯**: ç»è¿‡ 100 ä¸‡+ å¹¶å‘ ID æµ‹è¯•ï¼Œé›¶é‡å¤
- **ğŸ“¦ å¤šç§æ ¼å¼**: æ”¯æŒå­—ç¬¦ä¸²å’Œ uint64 ID ç”Ÿæˆ
- **ğŸ­ å¤šå®ä¾‹æ”¯æŒ**: æ”¯æŒå¤šä¸ªç‹¬ç«‹çš„ç”Ÿæˆå™¨å®ä¾‹
- **ğŸŒ æœºå™¨æ„ŸçŸ¥**: ä¸ºåˆ†å¸ƒå¼ç¯å¢ƒé›†æˆæœºå™¨ ID
- **âš¡ é›¶ä¾èµ–**: çº¯ Go å®ç°ï¼Œä»…ä½¿ç”¨æ ‡å‡†åº“

## å®‰è£…

```bash
go get -u github.com/tinystack/tsuniqid
```

## å¿«é€Ÿå¼€å§‹

### åŒ…çº§åˆ«å‡½æ•°ï¼ˆæ¨èï¼‰

```go
package main

import (
    "fmt"
    "github.com/tinystack/tsuniqid"
)

func main() {
    // ç”Ÿæˆå­—ç¬¦ä¸² ID
    stringID := tsuniqid.UniqID()
    fmt.Println("å­—ç¬¦ä¸² ID:", stringID) // ä¾‹å¦‚: "1a2b3c4d5e6f78901a2b3c4d"

    // ç”Ÿæˆ uint64 ID
    uint64ID := tsuniqid.UniqUID()
    fmt.Println("Uint64 ID:", uint64ID) // ä¾‹å¦‚: 1844674407370955161
}
```

### ç”Ÿæˆå™¨å®ä¾‹

```go
package main

import (
    "fmt"
    "github.com/tinystack/tsuniqid"
)

func main() {
    // åˆ›å»ºç‹¬ç«‹çš„ç”Ÿæˆå™¨å®ä¾‹
    gen1 := tsuniqid.NewGenerator()
    gen2 := tsuniqid.NewGenerator()

    // ä»ä¸åŒå®ä¾‹ç”Ÿæˆ ID
    id1 := gen1.GenerateStringID()
    id2 := gen2.GenerateUint64ID()

    fmt.Println("ç”Ÿæˆå™¨ 1 å­—ç¬¦ä¸² ID:", id1)
    fmt.Println("ç”Ÿæˆå™¨ 2 Uint64 ID:", id2)
}
```

## API å‚è€ƒ

### åŒ…å‡½æ•°

| å‡½æ•°                 | æè¿°               | è¿”å›ç±»å‹ | æ€§èƒ½       |
| -------------------- | ------------------ | -------- | ---------- |
| `tsuniqid.UniqID()`  | ç”Ÿæˆå”¯ä¸€å­—ç¬¦ä¸² ID  | `string` | ~443 ns/op |
| `tsuniqid.UniqUID()` | ç”Ÿæˆå”¯ä¸€ uint64 ID | `uint64` | ~24 ns/op  |

### ç”Ÿæˆå™¨æ–¹æ³•

| æ–¹æ³•                 | æè¿°                 | è¿”å›ç±»å‹       |
| -------------------- | -------------------- | -------------- |
| `NewGenerator()`     | åˆ›å»ºæ–°çš„ç”Ÿæˆå™¨å®ä¾‹   | `*IDGenerator` |
| `GenerateStringID()` | ä»å®ä¾‹ç”Ÿæˆå­—ç¬¦ä¸² ID  | `string`       |
| `GenerateUint64ID()` | ä»å®ä¾‹ç”Ÿæˆ uint64 ID | `uint64`       |

## ID ç»“æ„

### å­—ç¬¦ä¸² ID æ ¼å¼

- **æ ¼å¼**: `{åå…­è¿›åˆ¶_uint64_id}{éšæœºåç¼€}`
- **é•¿åº¦**: 24 ä¸ªå­—ç¬¦ï¼ˆ16 å­—ç¬¦åå…­è¿›åˆ¶ + 8 å­—ç¬¦éšæœºåç¼€ï¼‰
- **ç¤ºä¾‹**: `"1a2b3c4d5e6f78901a2b3c4d"`

### Uint64 ID ä½å¸ƒå±€ï¼ˆæ€»å…± 64 ä½ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ä½èŒƒå›´    â”‚    å¤§å°     â”‚                 æè¿°                     â”‚      èŒƒå›´      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   63-60     â”‚   4 ä½      â”‚              æœºå™¨ ID                     â”‚      0-15      â”‚
â”‚   59-56     â”‚   4 ä½      â”‚             å®ä¾‹ ID                      â”‚      0-15      â”‚
â”‚   55-14     â”‚   42 ä½     â”‚          æ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰                 â”‚   0-4398046511103 â”‚
â”‚   13-0      â”‚   14 ä½     â”‚               è®¡æ•°å™¨                     â”‚     0-16383    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## é«˜çº§ç”¨æ³•

### å¹¶å‘ç”Ÿæˆ

```go
package main

import (
    "fmt"
    "sync"
    "github.com/tinystack/tsuniqid"
)

func main() {
    const numGoroutines = 100
    const idsPerGoroutine = 1000

    var wg sync.WaitGroup
    uniqueIDs := make(map[string]bool)
    var mu sync.Mutex

    // å¯åŠ¨å¹¶å‘ ID ç”Ÿæˆ
    for i := 0; i < numGoroutines; i++ {
        wg.Add(1)
        go func() {
            defer wg.Done()

            for j := 0; j < idsPerGoroutine; j++ {
                id := tsuniqid.UniqID()

                mu.Lock()
                uniqueIDs[id] = true
                mu.Unlock()
            }
        }()
    }

    wg.Wait()
    fmt.Printf("ç”Ÿæˆäº† %d ä¸ªå”¯ä¸€ ID\n", len(uniqueIDs))
}
```

### ID ç»„ä»¶åˆ†æ

```go
package main

import (
    "fmt"
    "time"
    "github.com/tinystack/tsuniqid"
)

func main() {
    id := tsuniqid.UniqUID()

    // æå–ç»„ä»¶
    machineID := (id >> 60) & 0xF
    instanceID := (id >> 56) & 0xF
    timestamp := (id >> 14) & 0x3FFFFFFFFFF
    counter := id & 0x3FFF

    fmt.Printf("ID: %d (0x%016x)\n", id, id)
    fmt.Printf("æœºå™¨ ID: %d\n", machineID)
    fmt.Printf("å®ä¾‹ ID: %d\n", instanceID)
    fmt.Printf("æ—¶é—´æˆ³: %d (%s)\n", timestamp,
        time.UnixMilli(int64(timestamp)).Format("2006-01-02 15:04:05.000"))
    fmt.Printf("è®¡æ•°å™¨: %d\n", counter)
}
```

## æ€§èƒ½åŸºå‡†æµ‹è¯•

### åŸºå‡†æµ‹è¯•ç»“æœ

```
BenchmarkUniqID-12                           408.9 ns/op
BenchmarkUniqUID-12                           27.43 ns/op
BenchmarkIDGenerator_GenerateStringID        397.6 ns/op
BenchmarkIDGenerator_GenerateUint64ID         24.85 ns/op
```

### æ€§èƒ½ç‰¹å¾

- **å­—ç¬¦ä¸² ID ç”Ÿæˆ**: ~240 ä¸‡æ¬¡æ“ä½œ/ç§’
- **Uint64 ID ç”Ÿæˆ**: ~3600 ä¸‡æ¬¡æ“ä½œ/ç§’
- **å†…å­˜åˆ†é…**: æœ€å°å †åˆ†é…
- **å¹¶å‘æ€§**: éš CPU æ ¸å¿ƒæ•°çº¿æ€§æ‰©å±•

## æµ‹è¯•å’Œè´¨é‡

### æµ‹è¯•è¦†ç›–ç‡

- âœ… **å”¯ä¸€æ€§æµ‹è¯•**: 100 ä¸‡+ å¹¶å‘ IDï¼Œé›¶é‡å¤
- âœ… **æ ¼å¼éªŒè¯**: å­—ç¬¦ä¸² ID æ ¼å¼å’Œ uint64 ä½å¸ƒå±€
- âœ… **å¹¶å‘å®‰å…¨**: å¤šåç¨‹å‹åŠ›æµ‹è¯•
- âœ… **ç»„ä»¶éªŒè¯**: æœºå™¨ IDã€æ—¶é—´æˆ³ã€è®¡æ•°å™¨èŒƒå›´
- âœ… **å¤šå®ä¾‹**: ç‹¬ç«‹ç”Ÿæˆå™¨éš”ç¦»
- âœ… **æ€§èƒ½åŸºå‡†**: ç»¼åˆæ€§èƒ½æµ‹è¯•

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
go test -v

# è¿è¡ŒåŸºå‡†æµ‹è¯•
go test -bench=. -benchmem

# ä½¿ç”¨ç«æ€æ£€æµ‹è¿è¡Œæµ‹è¯•
go test -race -v

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
go test -coverprofile=coverage.out
go tool cover -html=coverage.out
```

## ä½¿ç”¨åœºæ™¯

- **ğŸ”— åˆ†å¸ƒå¼ç³»ç»Ÿ**: æ„ŸçŸ¥æœºå™¨çš„åˆ†å¸ƒå¼ç¯å¢ƒ ID
- **ğŸ“Š æ•°æ®åº“è®°å½•**: åµŒå…¥æ—¶é—´æˆ³ä¿¡æ¯çš„ä¸»é”®
- **ğŸŒ Web åº”ç”¨**: è¯·æ±‚ IDã€ä¼šè¯ä»¤ç‰Œã€API å¯†é’¥
- **ğŸ“ æ—¥å¿—ç³»ç»Ÿ**: åˆ†å¸ƒå¼è¿½è¸ªçš„ Trace ID
- **ğŸ”„ æ¶ˆæ¯é˜Ÿåˆ—**: å¸¦æœ‰æ’åºä¿¡æ¯çš„æ¶ˆæ¯æ ‡è¯†ç¬¦
- **ğŸ“± å¾®æœåŠ¡**: æœåŠ¡å®ä¾‹è¯†åˆ«å’Œå…³è”

## æ¶æ„

### è®¾è®¡åŸåˆ™

- **é«˜æ€§èƒ½**: é’ˆå¯¹é€Ÿåº¦ä¼˜åŒ–ï¼Œæœ€å°åŒ–åˆ†é…
- **çº¿ç¨‹å®‰å…¨**: å°½å¯èƒ½ä½¿ç”¨æ— é”åŸå­æ“ä½œ
- **å”¯ä¸€æ€§ä¿è¯**: æ•°å­¦ä¿è¯ ID å”¯ä¸€æ€§
- **çµæ´»æ€§**: æ”¯æŒå¤šç§æ ¼å¼å’Œç”Ÿæˆå™¨å®ä¾‹
- **ç®€æ´æ€§**: æ¸…æ™°çš„ APIï¼Œå­¦ä¹ æ›²çº¿æœ€å°

### æœºå™¨ ID ç”Ÿæˆ

- åŸºäºä¸»æœºåå’Œæœ¬åœ° IP åœ°å€
- SHA1 å“ˆå¸Œç”¨äºç¡®å®šæ€§ç”Ÿæˆ
- å¦‚æœç½‘ç»œä¿¡æ¯ä¸å¯ç”¨ï¼Œå›é€€åˆ°éšæœºç”Ÿæˆ
- 4 ä½æœºå™¨ ID æ”¯æŒæœ€å¤š 16 å°æœºå™¨

### å®ä¾‹ ID ç³»ç»Ÿ

- åŸå­è®¡æ•°å™¨ç”¨äºå”¯ä¸€å®ä¾‹æ ‡è¯†
- 4 ä½å®ä¾‹ ID æ”¯æŒæ¯å°æœºå™¨æœ€å¤š 16 ä¸ªç”Ÿæˆå™¨
- é˜²æ­¢å¤šä¸ªç”Ÿæˆå™¨å®ä¾‹ä¹‹é—´çš„å†²çª

## ç¤ºä¾‹

æŸ¥çœ‹ [`examples/`](examples/) ç›®å½•ä¸­çš„ç»¼åˆç¤ºä¾‹ï¼š

- **åŸºæœ¬ç”¨æ³•**: ç®€å•çš„ ID ç”Ÿæˆç¤ºä¾‹
- **å¹¶å‘ç”¨æ³•**: å¤šåç¨‹å®‰å…¨ ID ç”Ÿæˆ
- **Web æœåŠ¡å™¨**: å¸¦æœ‰å”¯ä¸€è¯·æ±‚ ID çš„ HTTP æœåŠ¡
- **å¾®æœåŠ¡**: å¸¦æœ‰è¯·æ±‚è¿½è¸ªçš„åˆ†å¸ƒå¼æœåŠ¡
- **æ•°æ®å­˜å‚¨**: å¸¦æœ‰å”¯ä¸€é”®çš„ç±»æ•°æ®åº“æ“ä½œ

è¿è¡Œç¤ºä¾‹ï¼š

```bash
cd examples
go run main.go
```

## è´¡çŒ®

1. Fork ä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some amazing feature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5. å¼€å¯ Pull Request

## è¦æ±‚

- Go 1.18 æˆ–æ›´é«˜ç‰ˆæœ¬
- æ— å¤–éƒ¨ä¾èµ–

## è®¸å¯è¯

è¯¥é¡¹ç›®æ ¹æ® MIT è®¸å¯è¯æˆæƒ - æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… [LICENSE](LICENSE) æ–‡ä»¶ã€‚

---

**ç”¨ â¤ï¸ ä¸º Go ç¤¾åŒºåˆ¶ä½œ**
